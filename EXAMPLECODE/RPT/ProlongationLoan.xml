<?xml version="1.0" encoding="UTF-8"?>
<Export generator="Cache" version="25">
<Class name="GUI.WEB.RPT.ProlongationLoan">
<Description>
Печатная форма: договор пролонгации</Description>
<IncludeCode>EMCConst,ApplicationSettingsConst</IncludeCode>
<Super>%ZEN.Component.page</Super>
<TimeCreated>62760,40645.564146</TimeCreated>

<Method name="OnPage">
<ClassMethod>1</ClassMethod>
<ReturnType>%Status</ReturnType>
<Implementation><![CDATA[
	set sc=##class(GUI.HistoryLog).CreateRecord("GUI.WEB.RPT.ProlongationLoan","WebForm","OnClick",1,"Печатная форма: договор пролонгации")
	// Подготовка данных для вывода на печать
	s TextMessage=..GetData(.Parameters)
	// В случае проблем подготовки данных
	set ^b = TextMessage
	i TextMessage'="" {
	&html<
	<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
	<html><head>
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
	<meta name=Generator content="FastReport 3.0 http://www.fast-report.com">
	<title></title>
	<body>#(TextMessage)#</body>
	</html>
	</html>>
	q $$$OK
	}
	// Вывод отчета
	&html<<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
<meta name=Generator content="FastReport 3.0 http://www.fast-report.com">
<title></title>
<style type="text/css"><!-- 
.page_break {page-break-before: always;}
.s0 {
 font-family: Times New Roman;
 font-size: 16px;
 color: #000000; font-style: normal;
 background-color: transparent;
 text-align: Justify; vertical-align: Top;
}
.s1 {
 font-family: Times New Roman;
 font-size: 16px;
 color: #000000; font-weight: bold; font-style: normal;
 background-color: transparent;
 text-align: Center; vertical-align: Top;
}
.s2 {
 font-family: Times New Roman;
 font-size: 16px;
 color: #000000; font-style: normal;
 background-color: transparent;
 text-align: Center; vertical-align: Top;
}
.s3 {
 font-family: Times New Roman;
 font-size: 16px;
 color: #000000; font-style: normal;
 background-color: transparent;
 text-align: Right; vertical-align: Middle;
}
.s4 {
 font-family: Times New Roman;
 font-size: 16px;
 color: #000000; font-style: normal;
 background-color: transparent;
 text-align: Left; vertical-align: Middle;
}
.s5 {
 font-family: Arial;
 font-size: 1px;
 color: #000000; font-style: normal;
 background-color: transparent;
 border-color:#000000; border-style: solid;
 border-left-width: 0px;
 border-right-width: 0px;
 border-top-width: 1;
 border-bottom-width: 0px;
 text-align: Left; vertical-align: Top;
}
.s6 {
 font-family: Times New Roman;
 font-size: 16px;
 color: #000000; font-style: normal;
 background-color: transparent;
 text-align: Justify; vertical-align: Top;
}
.s7 {
 font-family: Times New Roman;
 font-size: 16px;
 color: #000000; font-style: normal;
 background-color: transparent;
 text-align: Left; vertical-align: Top;
}
.s8 {
 font-family: Times New Roman;
 font-size: 13px;
 color: #000000; font-weight: bold; font-style: normal;
 background-color: transparent;
 text-align: Center; vertical-align: Top;
}
.s9 {
 font-family: Times New Roman;
 font-size: 13px;
 color: #000000; font-style: normal;
 background-color: transparent;
 text-align: Left; vertical-align: Top;
}
.s10 {
 font-family: Times New Roman;
 font-size: 12px;
 color: #000000; font-style: normal;
 background-color: transparent;
 text-align: Left; vertical-align: Top;
}
.s11 {
 font-family: Times New Roman;
 font-size: 13px;
 color: #000000; font-style: normal;
 background-color: transparent;
 text-align: Center; vertical-align: Top;
}
.s12 {
 font-family: Times New Roman;
 font-size: 16px;
 color: #000000; font-weight: bold; font-style: normal;
 background-color: transparent;
 text-align: Left; vertical-align: Middle;
}
.s13 {
 font-family: Times New Roman;
 font-size: 16px;
 color: #000000; font-style: normal;
 background-color: transparent;
 text-align: Right; vertical-align: Top;
}
.s14 {
 font-family: Times New Roman;
 font-size: 15px;
 color: #000000; font-style: normal;
 background-color: transparent;
 text-align: Left; vertical-align: Top;
}
.s15 {
 font-family: Arial;
 font-size: 13px;
 color: #000000; font-style: normal;
 background-color: transparent;
 text-align: Right; vertical-align: Top;
}
.s16 {
 font-family: Times New Roman;
 font-size: 19px;
 color: #000000; font-weight: bold; font-style: normal;
 background-color: transparent;
 text-align: Center; vertical-align: Top;
}
.s17 {
 font-family: Times New Roman;
 font-size: 16px;
 color: #000000; font-weight: bold; font-style: normal;
 background-color: transparent;
 text-align: Left; vertical-align: Top;
}
.s18 {
 font-family: Times New Roman;
 font-size: 16px;
 color: #000000; font-style: normal;
 background-color: #D4D0C8;
 border-color:#000000; border-style: solid;
 border-left-width: 1;
 border-right-width: 1;
 border-top-width: 1;
 border-bottom-width: 1;
 text-align: Center; vertical-align: Middle;
}
.s19 {
 font-family: Times New Roman;
 font-size: 13px;
 color: #000000; font-style: normal;
 background-color: transparent;
 border-color:#000000; border-style: solid;
 border-left-width: 1;
 border-right-width: 1;
 border-top-width: 1;
 border-bottom-width: 1;
 text-align: Center; vertical-align: Top;
}
.s20 {
 font-family: Times New Roman;
 font-size: 13px;
 color: #000000; font-style: normal;
 background-color: transparent;
 border-color:#000000; border-style: solid;
 border-left-width: 1;
 border-right-width: 1;
 border-top-width: 1;
 border-bottom-width: 1;
 text-align: Right; vertical-align: Top;
}
.s21 {
 font-family: Times New Roman;
 font-size: 13px;
 color: #000000; font-weight: bold; font-style: normal;
 background-color: transparent;
 border-color:#000000; border-style: solid;
 border-left-width: 1;
 border-right-width: 1;
 border-top-width: 1;
 border-bottom-width: 1;
 text-align: Right; vertical-align: Top;
}
.s22 {
 font-family: Arial;
 font-size: 13px;
 color: #000000; font-style: normal;
 background-color: transparent;
 border-color:#000000; border-style: solid;
 border-left-width: 1;
 border-right-width: 1;
 border-top-width: 1;
 border-bottom-width: 1;
 text-align: Right; vertical-align: Top;
}
.s23 {
 font-family: Times New Roman;
 font-size: 13px;
 color: #000000; font-weight: bold; font-style: normal;
 background-color: transparent;
 border-color:#000000; border-style: solid;
 border-left-width: 1;
 border-right-width: 1;
 border-top-width: 1;
 border-bottom-width: 1;
 text-align: Center; vertical-align: Middle;
}
.s24 {
 font-family: Times New Roman;
 font-size: 16px;
 color: #000000; font-style: normal;
 background-color: #D4D0C8;
 border-color:#000000; border-style: solid;
 border-left-width: 0px;
 border-right-width: 1;
 border-top-width: 1;
 border-bottom-width: 1;
 text-align: Center; vertical-align: Middle;
}
.s25 {
 font-family: Times New Roman;
 font-size: 13px;
 color: #000000; font-style: normal;
 background-color: transparent;
 border-color:#000000; border-style: solid;
 border-left-width: 1;
 border-right-width: 1;
 border-top-width: 0px;
 border-bottom-width: 1;
 text-align: Center; vertical-align: Top;
}
.s26 {
 font-family: Times New Roman;
 font-size: 13px;
 color: #000000; font-style: normal;
 background-color: transparent;
 border-color:#000000; border-style: solid;
 border-left-width: 0px;
 border-right-width: 1;
 border-top-width: 0px;
 border-bottom-width: 1;
 text-align: Right; vertical-align: Top;
}
.s27 {
 font-family: Times New Roman;
 font-size: 13px;
 color: #000000; font-weight: bold; font-style: normal;
 background-color: transparent;
 border-color:#000000; border-style: solid;
 border-left-width: 1;
 border-right-width: 1;
 border-top-width: 0px;
 border-bottom-width: 1;
 text-align: Center; vertical-align: Middle;
}
.s28 {
 font-family: Times New Roman;
 font-size: 13px;
 color: #000000; font-weight: bold; font-style: normal;
 background-color: transparent;
 border-color:#000000; border-style: solid;
 border-left-width: 0px;
 border-right-width: 1;
 border-top-width: 0px;
 border-bottom-width: 1;
 text-align: Right; vertical-align: Top;
}
.s29 {
 font-family: Arial;
 font-size: 13px;
 color: #000000; font-style: normal;
 background-color: transparent;
 border-color:#000000; border-style: solid;
 border-left-width: 0px;
 border-right-width: 1;
 border-top-width: 0px;
 border-bottom-width: 1;
 text-align: Right; vertical-align: Top;
}
.s30 {
 font-family: Times New Roman;
 font-size: 13px;
 color: #000000; font-style: normal;
 background-color: transparent;
 border-color:#000000; border-style: solid;
 border-left-width: 1;
 border-right-width: 1;
 border-top-width: 0px;
 border-bottom-width: 1;
 text-align: Center; vertical-align: Top;
}
.s31 {
 font-family: Times New Roman;
 font-size: 13px;
 color: #000000; font-style: normal;
 background-color: transparent;
 border-color:#000000; border-style: solid;
 border-left-width: 0px;
 border-right-width: 1;
 border-top-width: 0px;
 border-bottom-width: 1;
 text-align: Right; vertical-align: Top;
}
.s32 {
 font-family: Times New Roman;
 font-size: 16px;
 color: #000000; font-style: normal;
 background-color: #D4D0C8;
 border-color:#000000; border-style: solid;
 border-left-width: 1;
 border-right-width: 1;
 border-top-width: 1;
 border-bottom-width: 1;
 text-align: Center; vertical-align: Middle;
}
.s33 {
 font-family: Times New Roman;
 font-size: 16px;
 color: #000000; font-style: normal;
 background-color: #D4D0C8;
 border-color:#000000; border-style: solid;
 border-left-width: 0px;
 border-right-width: 1;
 border-top-width: 1;
 border-bottom-width: 1;
 text-align: Center; vertical-align: Middle;
}
--></style>
</head>
<body onload="printpage()"
 bgcolor="#FFFFFF" text="#000000">
 <script language="Javascript1.2">
	function printpage()
	{
		window.print();
	}
	</script>
<a name="PageN1"></a>
<table width="769" border="0" cellspacing="0" cellpadding="0">
<tr style="height: 1px"><td width="4"/><td width="9"/><td width="47"/><td width="28"/><td width="8"/><td width="1"/><td width="1"/><td width="38"/><td width="15"/><td width="90"/><td width="34"/><td width="4"/><td width="1"/><td width="41"/><td width="30"/><td width="9"/><td width="2"/><td width="3"/><td width="16"/><td width="15"/><td width="19"/><td width="1"/><td width="3"/><td width="19"/><td width="38"/><td width="2"/><td width="36"/><td width="15"/><td width="26"/><td width="4"/><td width="30"/><td width="11"/><td width="4"/><td width="19"/><td width="42"/><td width="17"/><td width="2"/><td width="19"/><td width="15"/><td width="4"/><td width="9"/><td width="26"/><td width="9"/><td width="2"/></tr>
<tr style="height:2px">
<td/><td/><td colspan="39" class="s1">Дополнительное соглашение № #(Parameters("Value","DocNumber"))#</td><td/><td/><td/>
</tr>
<tr style="height:16px">
<td/><td/><td colspan="24" class="s1" style="font-size:1px"> </td><td colspan="18" rowspan="2" class="s12"></td>
</tr>
<tr style="height:1px">
<td/><td/><td/><td/><td/><td/><td/><td/><td/><td/><td/><td/><td/><td/><td/><td/><td/><td/><td/><td/><td/><td/><td/><td/><td/><td/>
</tr>
<tr style="height:1px">
<td/><td/><td/><td/><td/><td/><td/><td/><td/><td/><td/><td/><td/><td/><td/><td/><td/><td/><td/><td/><td/><td/><td/><td/><td/><td/><td/><td/><td/><td/><td/><td/><td/><td/><td/><td/><td/><td/><td/><td/><td/><td/><td/><td/>
</tr>
<tr style="height:32px">
<td/><td/><td colspan="39" class="s2">к договору займа  № #(Parameters("Value","SysCode"))# от #(Parameters("Value","RegDateH"))# года</td><td/><td/><td/>
</tr>
<tr style="height:23px">
<td/><td/><td/><td/><td/><td/><td/><td/><td/><td/><td/><td/><td/><td/><td/><td/><td/><td/><td/><td/><td/><td/><td/><td/><td/><td/><td/><td/><td/><td/><td/><td/><td/><td/><td/><td/><td/><td/><td/><td/><td/><td/><td/><td/>
</tr>
<tr style="height:18px">
<td/><td/><td/><td colspan="12" class="s4">г. #(Parameters("Value","City"))#</td><td/><td/><td/><td/><td/><td/><td/><td/><td/><td/><td/><td/><td colspan="8" rowspan="2" class="s3">#(Parameters("Value","RegDateD"))# г.</td><td/><td/><td/><td/><td/><td/><td/><td/><td/>
</tr>
<tr style="height:1px">
<td/><td/><td/><td/><td/><td/><td/><td/><td/><td/><td/><td/><td/><td/><td/><td/><td/><td/><td/><td/><td/><td/><td/><td/><td/><td/><td/><td/><td/><td/><td/><td/><td/><td/><td/><td/>
</tr>
<tr style="height:22px">
<td/><td/><td/><td/><td/><td/><td/><td/><td/><td/><td/><td/><td/><td/><td/><td/><td/><td/><td/><td/><td/><td/><td/><td/><td/><td/><td/><td/><td/><td/><td/><td/><td/><td/><td/><td/><td/><td/><td/><td/><td/><td/><td/><td/>
</tr>
<tr style="height:1px">
<td/><td/><td/><td colspan="33" rowspan="2" class="s0">        Микрофинансовая организация #(Parameters("Value","lOrganisation"))#, в лице #(Parameters("Value","EmplName"))#, действующего на основании доверенности № #(Parameters("Value","WarrntNumber"))# от #(Parameters("Value","WarrntDate"))#, именуемое в  дальнейшем «Заимодавец», с одной стороны, и #(Parameters("Value","ClientName"))#, именуемый(ая) в дальнейшем «Заемщик», действующий(ая) как физическое лицо с другой стороны, вместе именуемые Стороны, в соответствии с п.3.8 Договора Займа, заключили настоящее дополнительное соглашение (далее – Соглашение) о нижеследующем:</td><td/><td/><td/><td/><td/><td/><td class="s5" style="font-size:1px"> </td><td/>
</tr>
<tr style="height:144px">
<td/><td/><td/><td/><td/><td/><td/><td/><td/><td/><td/>
</tr>
<tr style="height:2px">
<td/><td/><td/><td colspan="33" rowspan="2" class="s6">        1. Пункт 1.1. Договора изложить  в следующей редакции:<br>        «1.1. Заимодавец предоставляет Заемщику в собственность денежные средства в размере #(Parameters("Value","lLoanSum"))##(Parameters("Value","lLoanSumProp"))# рублей (далее – сумма займа), со сроком возврата не позднее #(Parameters("Value","lEndDate"))#»</td><td/><td/><td/><td/><td/><td/><td/><td/>
</tr>
<tr style="height:71px">
<td/><td/><td/><td/><td/><td/><td/><td/><td/><td/><td/>
</tr>
<tr style="height:2px">
<td/><td/><td/><td/><td/><td/><td/><td/><td/><td/><td/><td/><td/><td/><td/><td/><td/><td/><td/><td/><td/><td/><td/><td/><td/><td/><td/><td/><td/><td/><td/><td/><td/><td/><td/><td/><td/><td/><td/><td/><td/><td/><td/><td/>
</tr>
<tr style="height:40px">
<td/><td/><td/><td colspan="34" class="s14">         2. Пункт 3.5 изложить в следующей редакции: «3.5. В случае досрочного погашения займа полностью, проценты начисляются за фактическое время пользование займом».</td><td/><td/><td/><td/><td/><td/><td/>
</tr>
<tr style="height:36px">
<td/><td/><td/><td colspan="33" class="s7">        3. Настоящее Соглашение является неотъемлемой частью Договора займа №  #(Parameters("Value","SysCode"))# от #(Parameters("Value","RegDate"))# г.</td><td/><td/><td/><td/><td/><td/><td/><td/>
</tr>
<tr style="height:36px">
<td/><td/><td/><td colspan="33" class="s7">        4. Остальные условия Договора займа № #(Parameters("Value","SysCode"))# от #(Parameters("Value","RegDate"))# г. остаются  неизменными и Стороны подтверждают по ним свои обязательства. </td><td/><td/><td/><td/><td/><td/><td/><td/>
</tr>
<tr style="height:36px">
<td/><td/><td/><td colspan="33" class="s7">        5. Настоящее Соглашение составлено в двух экземплярах,  имеющих одинаковую юридическую силу,  по одному для каждой из Сторон.</td><td/><td/><td/><td/><td/><td/><td/><td/>
</tr>
<tr style="height:36px">
<td/><td/><td/><td colspan="33" class="s6">        6. Настоящее Соглашение вступает в силу с момента его подписания Сторонами.</td><td/><td/><td/><td/><td/><td/><td/><td/>
</tr>
<tr style="height:6px">
<td/><td/><td/><td/><td/><td/><td/><td/><td/><td/><td/><td/><td/><td/><td/><td/><td/><td/><td/><td/><td/><td/><td/><td/><td/><td/><td/><td/><td/><td/><td/><td/><td/><td/><td/><td/><td/><td/><td/><td/><td/><td/><td/><td/>
</tr>
<tr style="height:17px">
<td/><td/><td/><td/><td/><td/><td/><td colspan="7" class="s8">Заимодавец</td><td/><td/><td/><td/><td/><td/><td colspan="14" class="s8">Заемщик</td><td/><td/><td/><td/><td/><td/><td/><td/><td/><td/>
</tr>
<tr style="height:7px">
<td/><td/><td/><td/><td/><td/><td/><td/><td/><td/><td/><td/><td/><td/><td/><td/><td/><td/><td/><td/><td/><td/><td/><td/><td/><td/><td/><td/><td/><td/><td/><td/><td/><td/><td/><td/><td/><td/><td/><td/><td/><td/><td/><td/>
</tr>
<tr style="height:37px">
<td/><td/><td/><td colspan="14" class="s9">#(Parameters("Value","lOrganisation"))#</td><td/><td/><td colspan="18" class="s10">#(Parameters("Value","ClientName"))#</td><td/><td/><td/><td/><td/><td/><td/>
</tr>
<tr style="height:10px">
<td/><td/><td/><td/><td/><td/><td/><td/><td/><td/><td/><td/><td/><td/><td/><td/><td/><td/><td/><td/><td/><td/><td/><td/><td/><td/><td/><td/><td/><td/><td/><td/><td/><td/><td/><td/><td/><td/><td/><td/><td/><td/><td/><td/>
</tr>
<tr style="height:18px">
<td/><td/><td/><td colspan="14" rowspan="2" class="s10">Юридический адрес: #(Parameters("Value","lOrgAddress"))#</td><td/><td/><td colspan="18" class="s10">Дата рождения :#(Parameters("Value","DateOfBirth"))#</td><td/><td/><td/><td/><td/><td/><td/>
</tr>
<tr style="height:15px">
<td/><td/><td/><td/><td/><td colspan="18" rowspan="5" class="s10">Адрес регистрации :  #(Parameters("Value","ClientRegAddr"))#</td><td/><td/><td/><td/><td/><td/><td/>
</tr>
<tr style="height:11px">
<td/><td/><td/><td/><td/><td/><td/><td/><td/><td/><td/><td/><td/><td/><td/><td/><td/><td/><td/><td/><td/><td/><td/><td/><td/><td/>
</tr>
<tr style="height:15px">
<td/><td/><td/><td colspan="14" class="s10">ИНН/КПП  #(Parameters("Value","lINNKPP"))#</td><td/><td/><td/><td/><td/><td/><td/><td/><td/>
</tr>
<tr style="height:2px">
<td/><td/><td/><td colspan="14" rowspan="4" class="s10">ОГРН #(Parameters("Value","lOGRN"))#</td><td/><td/><td/><td/><td/><td/><td/><td/><td/>
</tr>
<tr style="height:2px">
<td/><td/><td/><td/><td/><td/><td/><td/><td/><td/><td/><td/>
</tr>
<tr style="height:7px">
<td/><td/><td/><td/><td/><td/><td/><td/><td/><td/><td/><td/><td/><td/><td/><td/><td/><td/><td/><td/><td/><td/><td/><td/><td/><td/><td/><td/><td/><td/>
</tr>
<tr style="height:7px">
<td/><td/><td/><td/><td/><td colspan="18" rowspan="3" class="s10">Серия/номер : #(Parameters("Value","ClientPassportSeries"))#</td><td/><td/><td/><td/><td/><td/><td/>
</tr>
<tr style="height:4px">
<td/><td/><td/><td/><td/><td/><td/><td/><td/><td/><td/><td/><td/><td/><td/><td/><td/><td/><td/><td/><td/><td/><td/><td/><td/><td/>
</tr>
<tr style="height:7px">
<td/><td/><td/><td colspan="15" rowspan="2" class="s10">Расчетный счет  #(Parameters("Value","lRS"))#</td><td/><td/><td/><td/><td/><td/><td/><td/>
</tr>
<tr style="height:9px">
<td/><td/><td/><td/><td/><td/><td/><td/><td/><td/><td/><td/><td/><td/><td/><td/><td/><td/><td/><td/><td/><td/><td/><td/><td/><td/><td/><td/><td/>
</tr>
<tr style="height:2px">
<td/><td/><td/><td/><td/><td/><td/><td/><td/><td/><td/><td/><td/><td/><td/><td/><td/><td/><td/><td/><td/><td/><td/><td/><td/><td/><td/><td/><td/><td/><td/><td/><td/><td/><td/><td/><td/><td/><td/><td/><td/><td/><td/><td/>
</tr>
<tr style="height:16px">
<td/><td/><td/><td colspan="13" rowspan="3" class="s10">#(Parameters("Value","lBank"))#</td><td/><td/><td/><td colspan="18" class="s10">Дата выдачи : #(Parameters("Value","ClientPassportIssuepsDate"))#</td><td/><td/><td/><td/><td/><td/><td/>
</tr>
<tr style="height:10px">
<td/><td/><td/><td/><td/><td/><td/><td/><td/><td/><td/><td/><td/><td/><td/><td/><td/><td/><td/><td/><td/><td/><td/><td/><td/><td/><td/><td/><td/><td/><td/>
</tr>
<tr style="height:6px">
<td/><td/><td/><td/><td/><td/><td colspan="18" rowspan="3" class="s10">Код подразделения : #(Parameters("Value","ClientPassportIssueCode"))#</td><td/><td/><td/><td/><td/><td/><td/>
</tr>
<tr style="height:2px">
<td/><td/><td/><td/><td/><td/><td/><td/><td/><td/><td/><td/><td/><td/><td/><td/><td/><td/><td/><td/><td/><td/><td/><td/><td/><td/>
</tr>
<tr style="height:12px">
<td/><td/><td/><td colspan="14" rowspan="2" class="s10">Корреспондентский счет  #(Parameters("Value","lKS"))#</td><td/><td/><td/><td/><td/><td/><td/><td/><td/>
</tr>
<tr style="height:4px">
<td/><td/><td/><td/><td/><td/><td/><td/><td/><td/><td/><td/><td/><td/><td/><td/><td/><td/><td/><td/><td/><td/><td/><td/><td/><td/><td/><td/><td/><td/>
</tr>
<tr style="height:6px">
<td/><td/><td/><td/><td/><td/><td/><td/><td/><td/><td/><td/><td/><td/><td/><td/><td/><td/><td/><td/><td/><td/><td/><td/><td/><td/><td/><td/><td/><td/><td/><td/><td/><td/><td/><td/><td/><td/><td/><td/><td/><td/><td/><td/>
</tr>
<tr style="height:15px">
<td/><td/><td/><td colspan="14" class="s10">БИК #(Parameters("Value","lBIK"))#</td><td/><td/><td colspan="18" rowspan="2" class="s10">Кем выдан : #(Parameters("Value","ClientPassportIssueDep"))#</td><td/><td/><td/><td/><td/><td/><td/>
</tr>
<tr style="height:33px">
<td/><td/><td/><td/><td/><td/><td/><td/><td/><td/><td/><td/><td/><td/><td/><td/><td/><td/><td/><td/><td/><td/><td/><td/><td/><td/>
</tr>
<tr style="height:18px">
<td/><td/><td/><td/><td/><td/><td/><td/><td/><td/><td/><td/><td/><td/><td/><td/><td/><td/><td/><td/><td/><td/><td/><td/><td/><td/><td/><td/><td/><td/><td/><td/><td/><td/><td/><td/><td/><td/><td/><td/><td/><td/><td/><td/>
</tr>
<tr style="height:1px">
<td/><td/><td/><td/><td/><td colspan="8" class="s5" style="font-size:1px"> </td><td/><td/><td/><td/><td/><td/><td/><td/><td colspan="12" class="s5" style="font-size:1px"> </td><td/><td/><td/><td/><td/><td/><td/><td/><td/><td/><td/>
</tr>
<tr style="height:6px">
<td/><td/><td/><td/><td/><td/><td/><td/><td/><td/><td/><td/><td/><td/><td/><td/><td/><td/><td/><td/><td/><td/><td/><td/><td/><td/><td/><td/><td/><td/><td/><td/><td/><td/><td/><td/><td/><td/><td/><td/><td/><td/><td/><td/>
</tr>
<tr style="height:21px">
<td/><td/><td/><td/><td/><td/><td colspan="5" class="s11">Подпись</td><td/><td/><td/><td/><td/><td/><td/><td/><td/><td/><td/><td colspan="10" class="s11">Подпись</td><td/><td/><td/><td/><td/><td/><td/><td/><td/><td/><td/><td/>
</tr>
<tr style="height:26px">
<td/><td/><td/><td/><td/><td/><td/><td/><td/><td/><td/><td/><td/><td/><td/><td/><td/><td/><td/><td/><td/><td/><td/><td/><td/><td/><td/><td/><td/><td/><td/><td/><td/><td/><td/><td/><td/><td/><td/><td/><td/><td/><td/><td/>
</tr>
<tr style="height:26px">
<td/><td/><td/><td/><td colspan="6" class="s9">М. П.</td><td/><td/><td/><td/><td/><td/><td/><td/><td/><td/><td/><td/><td/><td/><td/><td/><td/><td/><td/><td/><td/><td/><td/><td/><td/><td/><td/><td/><td/><td/><td/><td/><td/><td/>
</tr>
<tr style="height:19px">
<td/><td/><td/><td/><td/><td/><td/><td/><td/><td/><td/><td/><td/><td/><td/><td/><td/><td/><td/><td/><td/><td/><td/><td/><td/><td/><td/><td/><td/><td/><td/><td/><td/><td/><td/><td/><td/><td/><td/><td/><td/><td/><td/><td/>
</tr>
<tr style="height:22px">
<td/><td/><td/><td/><td/><td/><td/><td/><td/><td/><td/><td/><td/><td/><td/><td/><td/><td/><td/><td/><td/><td/><td/><td/><td colspan="13" class="s13">Стр. 1 из 2</td><td/><td/><td/><td/><td/><td/><td/>
</tr>
<tr style="height:7px">
<td/><td/><td/><td/><td/><td/><td/><td/><td/><td/><td/><td/><td/><td/><td/><td/><td/><td/><td/><td/><td/><td/><td/><td/><td colspan="7" class="s13" style="font-size:1px"> </td><td colspan="6" rowspan="2" class="s15" style="font-size:1px"> </td><td/><td/><td/><td/><td/><td/><td/>
</tr>
<tr style="height:11px">
<td/><td/><td/><td/><td/><td/><td/><td/><td/><td/><td/><td/><td/><td/><td/><td/><td/><td/><td/><td/><td/><td/><td/><td/><td/><td/><td/><td/><td/><td/><td/><td/><td/><td/><td/><td/><td/><td/>
</tr>
</table>
<br style="page-break-before: always">
<a name="PageN2"></a>
<table width="769" border="0" cellspacing="0" cellpadding="0">
<tr style="height: 1px"><td width="4"/><td width="9"/><td width="47"/><td width="28"/><td width="8"/><td width="1"/><td width="1"/><td width="38"/><td width="15"/><td width="90"/><td width="34"/><td width="4"/><td width="1"/><td width="41"/><td width="30"/><td width="9"/><td width="2"/><td width="3"/><td width="16"/><td width="15"/><td width="19"/><td width="1"/><td width="3"/><td width="19"/><td width="38"/><td width="2"/><td width="36"/><td width="15"/><td width="26"/><td width="4"/><td width="30"/><td width="11"/><td width="4"/><td width="19"/><td width="42"/><td width="17"/><td width="2"/><td width="19"/><td width="15"/><td width="4"/><td width="9"/><td width="26"/><td width="9"/><td width="2"/></tr>
<tr style="height:29px">
<td/><td/><td/><td/><td/><td/><td/><td/><td/><td/><td/><td/><td/><td/><td/><td/><td/><td/><td/><td/><td/><td/><td/><td/><td/><td/><td/><td/><td/><td/><td/><td/><td/><td/><td/><td/><td/><td/><td/><td/><td/><td/><td/><td/>
</tr>
<tr style="height:81px">
<td/><td/><td/><td/><td/><td/><td/><td/><td/><td/><td/><td/><td/><td/><td/><td/><td/><td/><td/><td/><td/><td/><td/><td/><td/><td/><td/><td/><td colspan="11" class="s17">Приложение № #(Parameters("Value","Number"))#<br>к Договору займа<br>от #(Parameters("Value","DateReg"))#<br>№ #(Parameters("Value","LoanNumber"))# </td><td/><td/><td/><td/><td/>
</tr>
<tr style="height:18px">
<td/><td/><td/><td/><td/><td/><td/><td/><td/><td/><td/><td/><td/><td/><td/><td/><td/><td/><td/><td/><td/><td/><td/><td/><td/><td/><td/><td/><td/><td/><td/><td/><td/><td/><td/><td/><td/><td/><td/><td/><td/><td/><td/><td/>
</tr>
<tr style="height:22px">
<td/><td/><td/><td/><td/><td/><td/><td/><td/><td colspan="20" class="s16">График платежей</td><td/><td/><td/><td/><td/><td/><td/><td/><td/><td/><td/><td/><td/><td/><td/>
</tr>
<tr style="height:26px">
<td/><td/><td/><td/><td/><td/><td/><td/><td/><td/><td/><td/><td/><td/><td/><td/><td/><td/><td/><td/><td/><td/><td/><td/><td/><td/><td/><td/><td/><td/><td/><td/><td/><td/><td/><td/><td/><td/><td/><td/><td/><td/><td/><td/>
</tr>
<tr style="height:95px">
<td/><td colspan="39" class="s7">Дата предоставления займа: #(Parameters("Value","DateVal"))#<br>Сумма займа: #(Parameters("Value","Sum"))# руб.<br>Ставка: #(Parameters("Value","Percent"))#<br>Выплата процентов производится: наличными<br>Количество дней пользования займом: #(Parameters("Value","Period"))#</td><td/><td/><td/><td/>
</tr>
<tr style="height:18px">
<td/><td/><td/><td/><td/><td/><td/><td/><td/><td/><td/><td/><td/><td/><td/><td/><td/><td/><td/><td/><td/><td/><td/><td/><td/><td/><td/><td/><td/><td/><td/><td/><td/><td/><td/><td/><td/><td/><td/><td/><td/><td/><td/><td/>
</tr>
<!--
<tr style="height:40px">
<td/><td colspan="7" class="s18">Дата платежа</td><td colspan="4" class="s24">Сумма основного долга</td><td colspan="11" class="s24">% за пользование</td><td colspan="7" class="s24">Платеж</td><td colspan="8" class="s24">Остаток основного долга</td><td/><td/><td/><td/><td/><td/>
</tr>
<tr style="height:18px">
<td/><td colspan="7" class="s25">28.08.2012</td><td colspan="4" class="s26">0.00</td><td colspan="11" class="s26">0.00</td><td colspan="7" class="s26">0.00</td><td colspan="8" class="s26">5 000.00</td><td/><td/><td/><td/><td/><td/>
</tr>
<tr style="height:18px">
<td/><td colspan="7" class="s25">10.09.2012</td><td colspan="4" class="s26">5 000.00</td><td colspan="11" class="s26">1 022.00</td><td colspan="7" class="s26">6 022.00</td><td colspan="8" class="s26">0.00</td><td/><td/><td/><td/><td/><td/>
</tr>
<tr style="height:18px">
<td/><td colspan="7" class="s27">ИТОГО:</td><td colspan="4" class="s28">5 000.00</td><td colspan="11" class="s28">1 022.00</td><td colspan="7" class="s28">6 022.00</td><td colspan="8" class="s29" style="font-size:1px"> </td><td/><td/><td/><td/><td/><td/>
</tr>
<tr style="height:26px">
<td/><td/><td/><td/><td/><td/><td/><td/><td/><td/><td/><td/><td/><td/><td/><td/><td/><td/><td/><td/><td/><td/><td/><td/><td/><td/><td/><td/><td/><td/><td/><td/><td/><td/><td/><td/><td/><td/><td/><td/><td/><td/><td/><td/>
</tr>-->
<tr style="height:40px">
<td/><td class="s32">Дата платежа</td><td colspan="2" class="s33">Сумма основного долга (в рублях)</td><td class="s33">Проценты за пользование займом (в рублях)</td><td colspan="4" class="s33">Платеж (в рублях)</td><td class="s33">Остаток основного долга (в рублях)</td><td/><td/><td/>
</tr>>
 //------------------------------------------------------------------------
 // Open instance of ResultSet for runtime mode of DISPLAY.
 s ID = Parameters("Value","id")
 s StartDate = Parameters("Value","StartDate") //$$$HorologToDateEdit(##class(BL.Docs.Loan).sGetCurrentGraphic(ID))
 s SQL="SELECT ID,pgPaysDate,pgBasicDebt,pgChargePercent,pgBasicDebtBalance FROM Temp.PaysGraphics WHERE pgLoanID = "_ID_" and pgStartDate = '"_StartDate_"'"
 s GetGP=##class(%ResultSet).%New("%DynamicQuery:SQL")
 s %sc=GetGP.Prepare(SQL) if $$$ISERR(%sc) {d ..ShowError(%sc) q}
 s %sc=GetGP.Execute() if $$$ISERR(%sc) {d ..ShowError(%sc) q}
	while GetGP.Next()
	{
		&html<<tr style="height:18px">>
		&html<<td/><td class="s30">>
		w $tr(($zd(GetGP.Get("pgPaysDate"),4)),"/",".")
		&html<</td><td colspan="2" class="s31">> 
		w (GetGP.Get("pgBasicDebt")) 
		&html<</td><td class="s31">> 
		w (GetGP.Get("pgChargePercent")) 
		&html<</td><td colspan="4" class="s31">> 
		w (GetGP.Get("pgBasicDebt"))+(GetGP.Get("pgChargePercent")) 
		&html<</td><td class="s31"> > 
		w (GetGP.Get("pgBasicDebtBalance"))
		&html<</td><td/><td/><td/>>
		&html<</tr>>
	}
 //----------------------------------------------------------------------
 &html<
<tr style="height:18px">
<td/><td class="s30">ИТОГО:</td><td colspan="2" class="s31">#(Parameters("Value","TotalBasicDebt"))#</td><td class="s31">#(Parameters("Value","TotalPercent"))#</td><td colspan="4" class="s31">#(Parameters("Value","TotalPays"))#</td>
<td class="s15" style="font-size:1px">. </td><td/><td/><td/>
</tr>
<tr style="height:26px">
<td/><td/><td/><td/><td/><td/><td/><td/><td/><td/><td/><td/><td/>
</tr>
<tr style="height:345px">
<td colspan="39" class="s7">      В соответствии с договором займа № #(Parameters("Value","LoanNumber"))# от #(Parameters("Value","DateReg"))# на сумму #(Parameters("Value","Sum"))# рублей я, #(Parameters("Value","FullName"))#, обязуюсь выплатить полученный заём и уплатить проценты за пользование займом согласно приведенному выше расчету, а также выплатить пени за несвоевременный возврат суммы займа.<br><br><br>Заемщик<br><br>______________________________/_______________________________________________/<br><br><br>Заимодавец<br><br>#(Parameters("Value","lOrganisation"))#<br><br>По доверенности ____________________/_________________________/<br><br>М.П.</td><td/><td/><td/><td/><td/>
</tr>
<tr style="height:284px">
<td/><td/><td/><td/><td/><td/><td/><td/><td/><td/><td/><td/><td/><td/><td/><td/><td/><td/><td/><td/><td/><td/><td/><td/><td/><td/><td/><td/><td/><td/><td/><td/><td/><td/><td/><td/><td/><td/><td/><td/><td/><td/><td/><td/>
</tr>
<tr style="height:22px">
<td/><td/><td/><td/><td/><td/><td/><td/><td/><td/><td/><td/><td/><td/><td/><td/><td/><td/><td/><td/><td/><td/><td/><td/><td/><td colspan="15" class="s13">Стр. 2 из 2</td><td/><td/><td/><td/>
</tr>
</table>
</body>
>
	quit $$$OK
]]></Implementation>
</Method>

<UDLText name="T">
<Content><![CDATA[
// Подготовка данных для вывода в отчете

]]></Content>
</UDLText>

<Method name="GetData">
<ClassMethod>1</ClassMethod>
<FormalSpec><![CDATA[&Parameters]]></FormalSpec>
<ReturnType>%String</ReturnType>
<Implementation><![CDATA[
	// Проверка входных параметров
	// id
	// Для теста set id = 27592552, StartDate = 62764, DateRegN = 62760
	// Инициализация данных
	set (LoanNumber,DateReg,DateVal,Percent,Sum,FullName,TotalPercent,TotalBasicDebt,TotalPays)=""
	set id=$g(%request.Data("ID",1))
	set StartDate=$g(%request.Data("StartDate",1))
	set DateRegN=$g(%request.Data("ardate",1))
	if id = "" quit "Не задан ID класса Docs.Loan"
	do ..Organization(.Parameters)
	set loan = ##class(Docs.Loan).%OpenId(id)
	If '$IsObject(loan)
	{
		quit "Не найден договор ID="_id $$$SysLogError($$$EMCSysErr,ErrText)
	}
	&SQL(SELECT SysCode,lDateReg,lDateValutation,lConditions->ptcProductTypeID->PTProcTek,
			lLoanAppID->laClientID->PersonID->FullName,lPeriodCurrent,lConditions->ptcProductTypeID->PTPercentRatePeriod,lProlongationPeriod,lLoanAppID->laPincode
			INTO :LoanNumber,:DateReg,:DateVal,:Percent,:FullName,:Period,:PTEd,:lProlongationPeriod,:PinCode
			FROM Docs.Loan WHERE ID = :id)
	if SQLCODE<0
	{
		set Err="Ошибка при получении данных по договору ID="_id_"^SQLCODE="_$SYSTEM.SQL.SQLCODE(SQLCODE)
		$$$SysLogError($$$EMCSysErr,Err)
		quit Err
	}
	if SQLCODE=100 quit "Не найдены данные по договору ID="_id
	set docs=##class(BL.Docs.Loan).GetLoanDocsItems(id)
	if $IsObject(docs) { s actPercent=docs.ldiConditions.ptcPercent}

	&SQL(SELECT pgBasicDebtBalance,pgNumber INTO :Sum,:Number
		FROM Temp.PaysGraphics
		WHERE pgLoanID = :id AND pgStartDate=:StartDate AND pgPeriodNumber=0)

	if SQLCODE<0
	{
		set Err="Ошибка при чтении строки графика на дату выдачи по договору ID="_id_"^SQLCODE="_$SYSTEM.SQL.SQLCODE(SQLCODE)
		$$$SysLogError($$$EMCSysErr,Err)
		quit Err
	}
	if SQLCODE=100 quit "Не найдена строка графика на дату выдачи по договору ID="_id

	&SQL(SELECT sum(pgChargePercent),sum(pgBasicDebt)
		INTO :TotalPercent,       :TotalBasicDebt
		FROM Temp.PaysGraphics
		WHERE pgLoanID = :id AND pgStartDate=:StartDate)
	if SQLCODE<0
	{
		set Err="Ошибка при вычислении итоговых сумм по графику по договору ID="_id_"^SQLCODE="_$SYSTEM.SQL.SQLCODE(SQLCODE)
		$$$SysLogError($$$EMCSysErr,Err)
		quit Err
	}

	// Перенести в BL - файл занят 
	&sql(select  pgPaysDate-pgStartDate+1 into :NumberPeriod from Temp.PaysGraphics
		where pgLoanID=:id and pgStartDate<=:StartDate having max(pgPaysDate)=pgPaysDate)
		if SQLCODE<0
		{
			set Err="Ошибка при вычислении периода по договору ID="_id_"^SQLCODE="_$SYSTEM.SQL.SQLCODE(SQLCODE)
			$$$SysLogError($$$EMCSysErr,Err)
			quit Err
		}
	if SQLCODE'=0 set NumberPeriod=""
	set:'DateReg DateReg=DateVal
	set:'DateVal DateVal=DateReg

	if StartDate>DateVal
	{
		set state=$$$scActive
		&SQL(SELECT ldiRegDate INTO :RegDateD FROM Docs.LoanDocsItems
			WHERE ldiLoanID=:id and status=:state and cls='Docs.LoanDocsItems' and ldiStartDate=:StartDate)
		if SQLCODE=100 s RegDateD=StartDate
	}
	else
	{
		set RegDateD=""
	}
	set Prol=$s(StartDate>DateVal:" , пролонгирован "_$$D^%FD(RegDateD,1),1:"")
	if StartDate>DateVal,+actPercent set Percent=actPercent
	set:DateReg>0 DateReg=$$D^%FD(DateReg,1)
	set:DateVal>0 DateVal=$$D^%FD(DateVal,1)
	// заполнение полей отчета вне датасета
	set Parameters("Value","id")=id
	set Parameters("Value","StartDate")=StartDate
	set Parameters("Value","LoanNumber")=LoanNumber
	set Parameters("Value","DateReg")=DateReg
	set Parameters("Value","DateVal")=DateVal_Prol
	set Parameters("Value","Percent")=$$$PrtProcForm(Percent)_" % "_$zcvt(##class(Docs.ProductType).PTPercentRatePeriodLogicalToDisplay(PTEd),"l")
	set Parameters("Value","Sum")=Sum
	set Parameters("Value","FullName")=FullName
	set Parameters("Value","TotalPercent")=TotalPercent
	set Parameters("Value","TotalBasicDebt")=TotalBasicDebt
	set Parameters("Value","TotalPays")=TotalPercent+TotalBasicDebt
	set Parameters("Value","Number")=Number
	set Parameters("Value","Period")=NumberPeriod

	set PrintPinCode=$$GetValue^ApplicationSettings($$$ApplicationSettingsPrintPinCode) 
	if PrintPinCode set Parameters("Value","PinCode")="Пинкод: "_PinCode
	else  set Parameters("Value","PinCode")=""

	set res=..OnGetVariables(id,$$$HorologToDateEdit(DateRegN),.Parameters)
	if $$$ISERR(res)
	
	
	///////
	;
	set Parameters("Value","Percent")=$$$PrtProcForm(Percent)_" % "_$zcvt(##class(Docs.ProductType).PTPercentRatePeriodLogicalToDisplay(PTEd),"l")
	&SQL(delete from Temp.PaysGraphics where pgLoanID = :id)
	quit ""
]]></Implementation>
</Method>

<Method name="OnGetVariables">
<Description>
d ##class(GUI.PRT.LoanCollateralAgreement).OnGetVariables(.Parameters)</Description>
<ClassMethod>1</ClassMethod>
<FormalSpec><![CDATA[Id,RegDatePar,&Parameters]]></FormalSpec>
<ReturnType>%Status</ReturnType>
<Implementation><![CDATA[
 s res=$$$OK
 s status=$$$scActive
 ;договор
 if Id'="" {
	 s obj=##class(Docs.Loan).%OpenId(Id)
	 if '$IsObject(obj)  q $$$ERROR($$$GeneralError,"Ошибка открытия объекта Docs.LoanApp ID="_Id)
	 s SysCode=obj.SysCode
	 s RegDate=obj.lDateReg
     s Parameters("Value","SysCode")=SysCode
     s Parameters("Value","RegDateH")=$$D^%FD(RegDate,"""d"" $m Y")
     s Parameters("Value","RegDate")=$$D^%FD(RegDate,"""d"" $m Y")
     if $IsObject(obj.lConditions.ptcProductTypeID) {
	     s Percent=obj.lConditions.ptcProductTypeID.PTProcTek
	     s RatePeriod=obj.lConditions.ptcProductTypeID.PTPercentRatePeriod
     }
     s Parameters("Value","Percent")=$$$PrtProcForm(Percent)_" % "_$zcvt(##class(Docs.ProductType).PTPercentRatePeriodLogicalToDisplay(RatePeriod),"l")

     ;клиент
     i $IsObject(obj.lLoanAppID.laClientID.PersonID) {
	     s Parameters("Value","ClientName")=obj.lLoanAppID.laClientID.PersonID.ObjectName
	     s DateOfBirth=obj.lLoanAppID.laClientID.PersonID.DateOfBirth
	     s Parameters("Value","DateOfBirth")=$$$HorologToDateEdit(DateOfBirth)
     }
	  ;Паспорт
     i $IsObject(obj.lLoanAppID.laPassportID) {
	     s Parameters("Value","ClientPassportSeries")=obj.lLoanAppID.laPassportID.psSeries
	     s Parameters("Value","ClientPassportNumber")=obj.lLoanAppID.laPassportID.psNumber
	     s Parameters("Value","ClientPassportIssueDep")=obj.lLoanAppID.laPassportID.psIssueDep
         s Parameters("Value","ClientPassportIssueCode")=obj.lLoanAppID.laPassportID.psIssueDepCode
         s Parameters("Value","ClientPassportIssuepsDate")=$$$HorologToDateEdit(obj.lLoanAppID.laPassportID.psDateIssue)
     }
     ;Адрес регистрации
     i $IsObject(obj.lLoanAppID.laRegAddrID) {
	     s addres=obj.lLoanAppID.laRegAddrID
	     s str=addres.GetAddressForLoanAppInfo()
	 	 s Parameters("Value","ClientRegAddr")=str
     }
	s RegDateD = RegDatePar
 	s RegDateDH = $$$DateEditToHorolog(RegDateD)
	 ;cотрудник, заключивший допсоглашение
	 s status=$$$scActive
	 s idLoan=obj.%Id()
	 &SQL(select id into :idCA from Docs.LoanDocsItems where cls='Docs.LoanDocsItems' and status=:status and ldiLoanID=:idLoan and ldiRegDate=:RegDateDH)
	 i SQLCODE=0 { 
	 	s objCA=##class(Docs.LoanDocsItems).%OpenId(idCA)
	 	i $IsObject(objCA) {
		 	 // If $IsObject(obj.lGiveOutEmployeeID.sePersonID) {
			 If $IsObject(objCA.ldiGiveOutEmployeeID.sePersonID) {
				 //s EmplID=obj.lGiveOutEmployeeID.%Id()
				 i (objCA.ldiGiveOutEmployeeID.sePersonID.Gender=2)  { s Parameters("Value","Deistv")="действующего(ей)"} else {s Parameters("Value","Deistv")="действующего(ей)"}
				 s EmplID=objCA.ldiGiveOutEmployeeID.%Id()
				 s EmplName=$zcvt(objCA.ldiGiveOutEmployeeID.sePersonID.FIO2,"u")
				 s Parameters("Value","EmplName")=EmplName
				 ;Доверенность
				 s scActive=$$$scActive
				 &SQL(select seWrntNumber,seWrntDate into :wNumber,:wFromDate from Subj.Employee
				  where id=:EmplID and Status=:scActive and seWrntDate<=:RegDate and seWrntLastDate>=:RegDate)
				 if SQLCODE=0 {
					 s Parameters("Value","WarrntNumber")=wNumber
					 s Parameters("Value","WarrntDate")=$$D^%FD(wFromDate,"""d"" $m Y г.")
				 } else {
					 s Parameters("Value","WarrntNumber")=""
					 s Parameters("Value","WarrntDate")=""
				 }
			 } else {
				 s Parameters("Value","WarrntNumber")=""
				 s Parameters("Value","WarrntDate")=""
			 }
		 	
		 	 // Указывать город из адреса расположения подразделения, пользователь которого формирует документ.
			 //If $IsObject(obj.lGiveOutEmployeeID.seOfficeID) {
				// If $IsObject(obj.lGiveOutEmployeeID.seOfficeID.offAddrID) {
			 If $IsObject(objCA.ldiGiveOutEmployeeID.seOfficeID) {
				 If $IsObject(objCA.ldiGiveOutEmployeeID.seOfficeID.offAddrID) {
				 	//s Parameters("Value","City")=obj.lGiveOutEmployeeID.seOfficeID.offAddrID.daCity
				 	s Parameters("Value","City")=objCA.ldiGiveOutEmployeeID.seOfficeID.offAddrID.daCity
				 } else {s Parameters("Value","City")=""}
			 } else {s Parameters("Value","City")=""}
		 } else {
			 s Parameters("Value","WarrntNumber")=""
			 s Parameters("Value","WarrntDate")=""
		 }

	 } else {
		 s Parameters("Value","WarrntNumber")=""
		 s Parameters("Value","WarrntDate")=""
	 }
 	&SQL(SELECT max(ldiNumber) into :NumberMax FROM Docs.LoanDocsItems WHERE  cls='Docs.LoanDocsItems' and ldiLoanID=:Id and status=:status)
	i SQLCODE=0 { s NumMax=NumberMax} else {s NumMax=0}
	&SQL(SELECT ldiStartDate,ldiNumber into :StartDate,:Number FROM Docs.LoanDocsItems WHERE  cls='Docs.LoanDocsItems' and ldiLoanID=:Id and status=:status and ldiRegDate=:RegDateDH)
	i SQLCODE=0 {
			&SQL(select max(pgPaysDate) into :PaysDate from docs.paysgraphics where pgStartDate=:StartDate and pgLoanID=:Id)
			i (SQLCODE=100) || (PaysDate="") {	
				// График еще не сформирован
				s Parameters("Value","lEndDate")=$$D^%FD(StartDate+obj.lProlongationPeriod-1,"""d"" $m Y г.") 
			} elseif SQLCODE=0 {	
				i NumberMax=Number {
					s Parameters("Value","lEndDate")=$$D^%FD(obj.lDateProposeConcl,"""d"" $m Y г.")  
				} else {
					s Parameters("Value","lEndDate")=$$D^%FD(PaysDate,"""d"" $m Y г.")  
				}
			} else {s Parameters("Value","lEndDate")=""}
		}
 
	 i obj.lSumm'="" {	 
	 	s Parameters("Value","lLoanSum")=obj.lSumm
		 s Parameters("Value","lLoanSumProp")=##class(System.TUtil).NumberToString(obj.lSumm)
	 }
	 else {
		 s Parameters("Value","lLoanSum")=""
		 s Parameters("Value","lLoanSumProp")=""
		}
	// Выбор требуемого доп. соглашения
	 i RegDateD'="" {
		 s RegDateD=$$$DateEditToHorolog(RegDateD)
		 set ^rnu = RegDateD
	 	s Parameters("Value","RegDateD")=$$D^%FD(RegDateD,"""d"" $m Y")
	 } else {
		 	 	s Parameters("Value","RegDateD")=""
	 }
	 s Parameters("Value","DocNumber")=Number
} else {
	 for i="HeadLine","SysCode","RegDate","ClientName","DateOfBirth","ClientRegAddr","EmplName","WarrntNumber","WarrntDate" s Parameters("Value",i)=""
	 for i="ClientPassportSeries","ClientPassportNumber","ClientPassportIssueDep","ClientPassportIssueCode","ClientPassportIssuepsDate" s Parameters("Value",i)=""
	 for i="lEndDate","lLoanSum","lLoanSumProp","City","RegDateD","DocNumber" s Parameters("Value",i)=""
 }
 q res
]]></Implementation>
</Method>

<UDLText name="T">
<Content><![CDATA[
//Реквизиты "Заимодавец"

]]></Content>
</UDLText>

<Method name="Organization">
<Description>
lOrganisation,lOrgAddress,lINNKPP,lRS,lKS,lOGRN,lBIK,lBank</Description>
<ClassMethod>1</ClassMethod>
<FormalSpec><![CDATA[&Parameters]]></FormalSpec>
<Implementation><![CDATA[
 set obj=##class(System.TInfoObject).%New()
 set res=##class(System.Options).GetOptions(obj,$$$ApplicationSettingsFirmName,.lOrganisation)
 set res=##class(System.Options).GetOptions(obj,$$$ApplicationSettingsOGRNOrg,.lOGRN)
 set res=##class(System.Options).GetOptions(obj,$$$ApplicationSettingsKPPOrg,.lKPP)
 set res=##class(System.Options).GetOptions(obj,$$$ApplicationSettingsINNOrg,.lINN)
 set res=##class(System.Options).GetOptions(obj,$$$ApplicationSettingsBIK,.lBIK)
 set res=##class(System.Options).GetOptions(obj,$$$ApplicationSettingsLoroAccount,.lKS)
 set res=##class(System.Options).GetOptions(obj,$$$ApplicationSettingsNameBank,.lBank)
 set res=##class(System.Options).GetOptions(obj,$$$ApplicationSettingsSetAccount,.lRS)
 set res=##class(System.Options).GetOptions(obj,$$$ApplicationSettingsPostIndexDeJureAddress,.lIndex)
 set res=##class(System.Options).GetOptions(obj,$$$ApplicationSettingsCityDeJureAddress,.lJureSity)
 set res=##class(System.Options).GetOptions(obj,$$$ApplicationSettingsLocationDeJureAddress,.lJureAddress) 
 set res=##class(System.Options).GetOptions(obj,$$$ApplicationSettingsPhoneVender,.lOrgPhone)

 s Parameters("Value","lOrganisation")=lOrganisation
 s Parameters("Value","lOrgAddress")=lIndex_","_lJureSity_","_lJureAddress
 s Parameters("Value","lOrgAddress1")=lIndex_","_lJureSity_","
 s Parameters("Value","lOrgAddress2")=lJureAddress
 s Parameters("Value","lINNKPP")=lINN_"/"_lKPP
 s Parameters("Value","lRS")=lRS
 s Parameters("Value","lBank")=lBank
 s Parameters("Value","lKS")=lKS
 s Parameters("Value","lOGRN")=lOGRN
 s Parameters("Value","lBIK")=lBIK
 s Parameters("Value","lOrgPhone")=lOrgPhone
]]></Implementation>
</Method>
</Class>
</Export>
